<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ğŸ† Ø¨Ø·ÙˆÙ„Ø© ÙƒØ±Ø© Ø§Ù„Ù‚Ø¯Ù…</title>

<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>

<style>
body{
  margin:0;
  font-family:Cairo,Arial;
  background:radial-gradient(circle at top,#1a1a1a,#000);
  color:#fff;
  text-align:center;
}
.container{max-width:520px;margin:auto;padding:20px}
h1{color:#d4af37;text-shadow:0 0 15px #d4af37}

/* LOGO */
.logo{
  width:120px;
  margin:10px auto;
  filter:drop-shadow(0 0 15px gold);
}

/* TROPHY */
.trophy{
  width:90px;
  margin:15px auto;
  animation:float 2.5s ease-in-out infinite;
  filter:drop-shadow(0 0 20px #d4af37);
}
@keyframes float{
  0%{transform:translateY(0)}
  50%{transform:translateY(-12px)}
  100%{transform:translateY(0)}
}

.card{
  background:#111;
  border:1px solid #d4af37;
  border-radius:16px;
  padding:15px;
  margin:10px 0;
  box-shadow:0 10px 25px #000;
}
.counter{font-size:22px;margin:10px 0}
.top3{display:flex;gap:8px}
.top3 div{
  flex:1;
  background:#000;
  border:1px solid #d4af37;
  border-radius:12px;
  padding:10px;
}

/* TEAMS */
#teams{display:none;margin-top:15px}
.team{
  padding:14px;
  margin:8px 0;
  border-radius:14px;
  background:linear-gradient(145deg,#111,#000);
  border:2px solid #d4af37;
  box-shadow:0 8px #8c6d1f;
  cursor:pointer;
  transition:.2s;
}
.team:active{transform:translateY(5px);box-shadow:0 3px #8c6d1f}
.team.taken{opacity:.35;pointer-events:none}
.team.selected{background:#d4af37;color:#000;font-weight:bold}

/* BUTTON */
button{
  width:100%;
  padding:16px;
  font-size:20px;
  border:none;
  border-radius:18px;
  background:linear-gradient(145deg,#d4af37,#b8962e);
  box-shadow:0 8px #8c6d1f;
  font-weight:bold;
}
button:active{transform:translateY(5px);box-shadow:0 3px #8c6d1f}
</style>
</head>

<body>
<div class="container">

  <img src="logo.png" class="logo">
  <img src="trophy.png" class="trophy">

  <h1>Ø¨Ø·ÙˆÙ„Ø© ÙƒØ±Ø© Ø§Ù„Ù‚Ø¯Ù…</h1>

  <div class="card">
    ğŸ’° Ø«Ù…Ù† Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ: <b>5 Ø¯Ø±Ø§Ù‡Ù…</b><br>
    ğŸ… Ø§Ù„Ø¬ÙˆØ§Ø¦Ø²: <b>100 Ø¯Ø±Ù‡Ù…</b> (Top 3)
  </div>

  <div class="counter" id="counter">0 / 32</div>

  <div class="card">
    <h3>ğŸ¥‡ Top 3</h3>
    <div class="top3">
      <div id="t1">---</div>
      <div id="t2">---</div>
      <div id="t3">---</div>
    </div>
  </div>

  <button id="showBtn">ğŸš€ Ø³Ø¬Ù‘Ù„ Ø§Ù„Ø¢Ù†</button>

  <div id="teams"></div>
</div>

<script>
const firebaseConfig = {
  apiKey: "XXXX",
  authDomain: "XXXX",
  databaseURL: "XXXX",
  projectId: "XXXX",
  storageBucket: "XXXX",
  messagingSenderId: "XXXX",
  appId: "XXXX"
};

firebase.initializeApp(firebaseConfig);
const db=firebase.database();
const teamsRef=db.ref("teams");
const countRef=db.ref("count");
const topRef=db.ref("top3");

let selectedKey=null, selectedName=null;

document.getElementById("showBtn").onclick=()=>{
  document.getElementById("teams").style.display="block";
};

teamsRef.on("value",s=>{
  const box=document.getElementById("teams");
  box.innerHTML="";
  const data=s.val();
  for(let k in data){
    const t=data[k];
    const d=document.createElement("div");
    d.className="team"+(t.taken?" taken":"");
    d.innerText=t.name;
    if(!t.taken){
      d.onclick=()=>{
        document.querySelectorAll(".team").forEach(e=>e.classList.remove("selected"));
        d.classList.add("selected");
        selectedKey=k;
        selectedName=t.name;
        confirmRegister();
      };
    }
    box.appendChild(d);
  }
});

function confirmRegister(){
  if(!confirm("ØªØ£ÙƒÙŠØ¯ Ø§Ù„ØªØ³Ø¬ÙŠÙ„ Ø¨ÙØ±Ù‚Ø© "+selectedName))return;
  teamsRef.child(selectedKey).transaction(t=>{
    if(t && !t.taken){t.taken=true;return t;}
    return;
  },(e,ok)=>{
    if(ok){
      countRef.transaction(c=>(c||0)+1);
      topRef.transaction(t=>{
        t=t||{};
        if(!t.one)t.one=selectedName;
        else if(!t.two)t.two=selectedName;
        else if(!t.three)t.three=selectedName;
        return t;
      });
      location.href="https://wa.me/212600000000?text="+
      encodeURIComponent("Ø³Ù„Ø§Ù…ØŒ ØªØ³Ø¬Ù„Øª ÙØ§Ù„Ø¨Ø·ÙˆÙ„Ø© Ø¨ÙØ±Ù‚Ø© "+selectedName);
    }else alert("Ø§Ù„ÙØ±Ù‚Ø© ØªØ®Ø¯Ø§Øª");
  });
}

countRef.on("value",s=>{
  document.getElementById("counter").innerText=(s.val()||0)+" / 32";
});
topRef.on("value",s=>{
  const t=s.val()||{};
  t1.innerText=t.one||"---";
  t2.innerText=t.two||"---";
  t3.innerText=t.three||"---";
});
</script>
</body>
</html>